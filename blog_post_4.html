<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TD with Linear Function Approximation in State Aggregated Setting</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #1F1F1F;
            color: #E6E6E6;
            line-height: 1.6;
        }
        header {
            background-color: #E6E6E6;
            color: #1F1F1F;
            padding: 2em 1em;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
        }
        .header-img {
            display: flex;
            align-items: center;
            margin-left: 5em;
        }
        header img {
            width: 150px;
            height: 150px;
        }
        header h1 {
            margin: 20px 0 0 0;
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            max-width: 1200px;
            text-align: center;
        }
        nav {
            background-color: #E6E6E6;
            margin: 0;
            padding: 0;
            text-align: center;
        }
        nav a {
            color: #1F1F1F;
            padding: 1em;
            text-decoration: none;
            display: inline-block;
            transition: background-color 0.3s ease, border-radius 0.3s ease;
        }
        nav a:hover {
            background-color: #D6596C;
            border-radius: 15px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2em;
        }
        .section {
            margin: 2em 0;
        }
        .section h2 {
            color: #D6596C;
        }
        .section h3 {
            color: #D6596C;
        }
        .projects img {
            max-width: 100%;
            height: auto;
        }
        .contact-info {
            list-style: none;
            padding: 0;
        }
        .contact-info li {
            margin: 0.5em 0;
        }
        .contact-info a {
            color: #D6596C;
            text-decoration: none;
        }
        .contact-info a:hover {
            text-decoration: underline;
        }
        section a {
            color: #D6596C;
            text-decoration: none;
        }
        section a:hover {
            text-decoration: underline;
        }
        footer {
            background-color: #333;
            color: white;
            text-align: center;
            padding: 1em 0;
            position: fixed;
            width: 100%;
            bottom: 0;
        }
    </style>
</head>
<body>
    <header>
        <h1>Controller convergence proof</h1>
    </header>
    <nav>
        <a href="index.html#about">About</a>
        <a href="projects.html">Projects</a>
        <a href="blog.html">Blog</a>
    </nav>
    <div class="container">
        <section id="Controller convergence proof" class="section">
            <h2>Proof of Convergence with Coupled Controllers</h2>
            <p>We aim to prove that the sequence of capacitance values \( \{(C_t^{(T)}, C_t^{(R)})\} \) generated by the transmitter and receiver controllers converges to the optimal pair \( (C_T^*, C_R^*) \) that maximizes the current \( I_t^R \) at the receiver.</p>
            <p>The objective:</p>
            <p>\[
                \max_{C_T,C_R\in C} I_t^R
            \]</p>

            <h3>Step 1: Unimodality of \( f(C_t^{(T)}, C_t^{(R)}) \)</h3>
            <p>The current at the receiver, \( I_t^R = f(C_t^{(T)}, C_t^{(R)}) \), is assumed to be unimodal with respect to both capacitances \( C_t^{(T)} \) and \( C_t^{(R)} \). This implies:</p>
            <p>\[
            \frac{\partial f(C_t^{(T)}, C_t^{(R)})}{\partial C_t^{(T)}} \begin{cases} 
            > 0 & \text{for } C_t^{(T)} < C_T^* \\
            = 0 & \text{for } C_t^{(T)} = C_T^* \\
            < 0 & \text{for } C_t^{(T)} > C_T^*
            \end{cases}\quad,\quad\frac{\partial f(C_t^{(T)}, C_t^{(R)})}{\partial C_t^{(R)}} \begin{cases} 
            > 0 & \text{for } C_t^{(R)} < C_R^* \\
            = 0 & \text{for } C_t^{(R)} = C_R^* \\
            < 0 & \text{for } C_t^{(R)} > C_R^*
            \end{cases}
            \]</p>

            <h3>Step 2: Controller Update Rules</h3>
            <p>Each controller updates its respective capacitance \( C_t^{(T)} \) and \( C_t^{(R)} \) as follows:</p>
            <p>\[
            C_{t+1}^{(T)} = C_t^{(T)} + \alpha_t^{(T)} \Delta_t^{(T)}
            \]
            \[
            C_{t+1}^{(R)} = C_t^{(R)} + \alpha_t^{(R)} \Delta_t^{(R)}
            \]</p>
            <p>Where \( \alpha_t^{(T)} \) and \( \alpha_t^{(R)} \) are the directions of adjustment determined by the sign of the change in \( I_t^R \), and \( \Delta_t^{(T)} \) and \( \Delta_t^{(R)} \) are the step sizes, which decrease over time.</p>

            <h3>Step 3: Coordinated Maximization</h3>
            <p>Both controllers aim to maximize \( I_t^R \). This coordination can be expressed by:</p>
            <ul>
                <li><b>If</b> \( I_t^R > I_{t-1}^R \), <b>then</b> the controller continues in the same direction.</li>
                <li><b>If</b> \( I_t^R \leq I_{t-1}^R \), <b>then</b> the controller reverses direction.</li>
            </ul>
            <p>The objective is to find the pair \( (C_t^{(T)}, C_t^{(R)}) \) such that:</p>
            <p>\[
            \frac{\partial f(C_t^{(T)}, C_t^{(R)})}{\partial C_t^{(T)}} = 0 \quad \text{and} \quad \frac{\partial f(C_t^{(T)}, C_t^{(R)})}{\partial C_t^{(R)}} = 0
            \]</p>

            <h3>Step 4: Convergence</h3>
            <p><b>Claim:</b> The sequence \( \{(C_t^{(T)}, C_t^{(R)})\} \) generated by the two controllers converges to a pair \( (C_T^*, C_R^*) \) that maximizes the current \( I_t^R \).</p>
            <p><b>Proof:</b></p>
            <ol>
                <li><b>Joint Monotonicity:</b> The function \( I_t^R = f(C_t^{(T)}, C_t^{(R)}) \) is unimodal with respect to both \( C_t^{(T)} \) and \( C_t^{(R)} \). Each controller adjusts its capacitance in a way that either increases \( I_t^R \) or reverses direction if \( I_t^R \) decreases. Thus, the sequence \( \{I_t^R\} \) is non-decreasing.</li>
                <li><b>Decreasing Step Size:</b> The step sizes \( \Delta_t^{(T)} \) and \( \Delta_t^{(R)} \) decrease over time, which ensures that as the system approaches the optimal pair \( (C_T^*, C_R^*) \), the adjustments become smaller, reducing the likelihood of overshooting.</li>
                <li><b>Coupled Dynamics:</b> Since \( I_t^R \) is a function of both \( C_t^{(T)} \) and \( C_t^{(R)} \), the changes made by one controller affect the outcome of the other. However, because both controllers are working to maximize the same objective function \( I_t^R \), the interaction is constructive rather than destructive.</li>
                <p>Mathematically, the convergence can be expressed as:</p>
                <p>\[
                \lim_{t \to \infty} \left( \frac{\partial f(C_t^{(T)}, C_t^{(R)})}{\partial C_t^{(T)}} \frac{\partial C_t^{(T)}}{\partial t} + \frac{\partial f(C_t^{(T)}, C_t^{(R)})}{\partial C_t^{(R)}} \frac{\partial C_t^{(R)}}{\partial t} \right) = 0
                \]</p>
                <p>This equation indicates that the system will stabilize at a point where both partial derivatives are zero, i.e., the current \( I_t^R \) is maximized with respect to both \( C_t^{(T)} \) and \( C_t^{(R)} \).</p>
                <li><b>Cauchy Sequence and Convergence:</b> The sequence \( \{(C_t^{(T)}, C_t^{(R)})\} \) is Cauchy due to the decreasing step sizes and the unimodal nature of the function. Since the sequence is bounded (within the physical limits of the capacitances) and Cauchy, it converges to a limit:</li>
                <p>\[
                \lim_{t \to \infty} (C_t^{(T)}, C_t^{(R)}) = (C_T^*, C_R^*)
                \]</p>
                <p>At this limit, the current \( I_t^R \) is maximized.</p>
            </ol>
            <p><b>Conclusion:</b></p>
            <p>By ensuring that both controllers operate in a coordinated manner to maximize the same objective function \( I_t^R \), and given that the system dynamics are unimodal and the step sizes decrease over time, the system converges to an optimal pair \( (C_T^*, C_R^*) \). This proves that the joint controller algorithm converges to the desired optimal state, maximizing the current at the receiver.</p>
        </section>
    </div>
</body>
</html>
